# Web UIÊ©üËÉΩ Áµ±ÂêàÂÆüË£Ö„Ç¨„Ç§„Éâ

## üìã Ê¶ÇË¶Å
„Çπ„Éû„Éº„Éà„Éó„É©„É≥„Çø„Éº„ÅÆWeb„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„ÄÅÊàêÈï∑Ë®òÈå≤„ÄÅË®≠ÂÆöÁîªÈù¢„ÅÆÂÆüË£ÖÊâãÈ†ÜÊõ∏

## üéØ ÂÆüË£ÖÁõÆÊ®ô
- „É™„Ç¢„É´„Çø„Ç§„É†„Çª„É≥„Çµ„Éº„Éá„Éº„ÇøË°®Á§∫
- Ê§çÁâ©„ÅÆÊàêÈï∑Ë®òÈå≤„Å®„Çø„Ç§„É†„É©„Éó„Çπ
- ÊâãÂãïÊìç‰ΩúÊ©üËÉΩÔºàÊíÆÂΩ±„ÄÅÁµ¶Ê∞¥Ôºâ
- „É¨„Çπ„Éù„É≥„Ç∑„Éñ„Éá„Ç∂„Ç§„É≥ÂØæÂøú
- Ë®≠ÂÆöÁîªÈù¢

## üõ†Ô∏è ÂøÖË¶Å„Å™Áí∞Â¢É

### „Éï„É≠„É≥„Éà„Ç®„É≥„Éâ
- HTML5, CSS3, JavaScript
- Chart.js („Ç∞„É©„ÉïË°®Á§∫)
- Bootstrap 5 („É¨„Çπ„Éù„É≥„Ç∑„Éñ„Éá„Ç∂„Ç§„É≥)
- WebSocket („É™„Ç¢„É´„Çø„Ç§„É†ÈÄö‰ø°)

### „Éê„ÉÉ„ÇØ„Ç®„É≥„Éâ
- Flask 2.3.3
- Flask-SocketIO (WebSocket)
- Êó¢Â≠ò„ÅÆ„Çª„É≥„Çµ„Éº„ÉªÁµ¶Ê∞¥„Ç∑„Çπ„ÉÜ„É†

## üìÅ „Éï„Ç°„Ç§„É´‰ΩúÊàêÊâãÈ†Ü

### Step 1: Web UI„Éá„Ç£„É¨„ÇØ„Éà„É™„ÅÆÁ¢∫Ë™ç
```bash
# „Éó„É≠„Ç∏„Çß„ÇØ„Éà„Éá„Ç£„É¨„ÇØ„Éà„É™„Å´ÁßªÂãï
cd /Users/ootsukayuya/wrok_space/sotugyouseisaku/smart-planter

# Web UI„Éá„Ç£„É¨„ÇØ„Éà„É™„ÅÆÁ¢∫Ë™ç
ls -la src/web/
ls -la src/web/templates/
ls -la src/web/static/
```

### Step 2: ÂêÑ„Éï„Ç°„Ç§„É´„ÅÆ‰ΩúÊàêÈ†ÜÂ∫è
1. `src/web/templates/base.html` - „Éô„Éº„Çπ„ÉÜ„É≥„Éó„É¨„Éº„Éà
2. `src/web/templates/dashboard.html` - „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ
3. `src/web/templates/settings.html` - Ë®≠ÂÆö„Éö„Éº„Ç∏
4. `src/web/static/css/main.css` - „É°„Ç§„É≥„Çπ„Çø„Ç§„É´
5. `src/web/static/js/main.js` - „É°„Ç§„É≥JavaScript

### Step 3: „Éï„Ç°„Ç§„É´‰ΩúÊàê„Ç≥„Éû„É≥„Éâ
```bash
# „ÉÜ„É≥„Éó„É¨„Éº„Éà„Éï„Ç°„Ç§„É´„Çí‰ΩúÊàê
touch src/web/templates/base.html
touch src/web/templates/dashboard.html
touch src/web/templates/settings.html

# ÈùôÁöÑ„Éï„Ç°„Ç§„É´„Çí‰ΩúÊàê
touch src/web/static/css/main.css
touch src/web/static/js/main.js
touch src/web/static/js/sensors.js
touch src/web/static/js/dashboard.js

# „Éá„Ç£„É¨„ÇØ„Éà„É™„ÅåÂ≠òÂú®„Åó„Å™„ÅÑÂ†¥Âêà„ÅØ‰ΩúÊàê
mkdir -p src/web/static/css
mkdir -p src/web/static/js
mkdir -p src/web/static/images
```

### Step 4: ‰æùÂ≠òÈñ¢‰øÇ„ÅÆËøΩÂä†
```bash
# ‰ªÆÊÉ≥Áí∞Â¢É„Çí„Ç¢„ÇØ„ÉÜ„Ç£„Éô„Éº„Éà
source venv/bin/activate

# WebSocketÈñ¢ÈÄ£„É©„Ç§„Éñ„É©„É™„Çí„Ç§„É≥„Çπ„Éà„Éº„É´
pip install Flask-SocketIO
pip install python-socketio

# requirements.txt„ÇíÊõ¥Êñ∞
pip freeze > requirements.txt
```

## üìÑ ÂÆüË£Ö„Ç≥„Éº„Éâ

### üìÑ src/web/templates/base.html
„Éô„Éº„Çπ„ÉÜ„É≥„Éó„É¨„Éº„Éà

```html
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}„Åô„Åè„Åô„Åè„Éü„É≥„Éà„Å°„ÇÉ„Çì{% endblock %}</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Socket.IO -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- „Ç´„Çπ„Çø„É†CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    
    {% block extra_head %}{% endblock %}
</head>
<body>
    <!-- „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Éê„Éº -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-success">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('index') }}">
                <i class="fas fa-seedling"></i> „Åô„Åè„Åô„Åè„Éü„É≥„Éà„Å°„ÇÉ„Çì
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('index') }}">
                            <i class="fas fa-home"></i> „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('settings') }}">
                            <i class="fas fa-cog"></i> Ë®≠ÂÆö
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('logs') }}">
                            <i class="fas fa-file-alt"></i> „É≠„Ç∞
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
    <main class="container mt-4">
        {% block content %}{% endblock %}
    </main>

    <!-- „Éï„ÉÉ„Çø„Éº -->
    <footer class="bg-light mt-5 py-4">
        <div class="container text-center">
            <p class="text-muted mb-0">
                &copy; 2025 „Åô„Åè„Åô„Åè„Éü„É≥„Éà„Å°„ÇÉ„Çì - „ÉÅ„Éº„É†KEBABS
            </p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- „Ç´„Çπ„Çø„É†JS -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    
    {% block extra_scripts %}{% endblock %}
</body>
</html>
```

### üìÑ src/web/templates/dashboard.html
„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„Éö„Éº„Ç∏

```html
{% extends "base.html" %}

{% block title %}„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ - „Åô„Åè„Åô„Åè„Éü„É≥„Éà„Å°„ÇÉ„Çì{% endblock %}

{% block content %}
<div class="row">
    <!-- „Ç∑„Çπ„ÉÜ„É†„Çπ„ÉÜ„Éº„Çø„Çπ -->
    <div class="col-12 mb-4">
        <div class="card">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="fas fa-info-circle"></i> „Ç∑„Çπ„ÉÜ„É†„Çπ„ÉÜ„Éº„Çø„Çπ</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-3">
                        <div class="text-center">
                            <h6>„Ç∑„Çπ„ÉÜ„É†Áä∂ÊÖã</h6>
                            <span id="system-status" class="badge bg-success">Á®ºÂÉç‰∏≠</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="text-center">
                            <h6>ÊúÄÁµÇÊõ¥Êñ∞</h6>
                            <span id="last-update">-</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="text-center">
                            <h6>Á®ºÂÉçÊôÇÈñì</h6>
                            <span id="uptime">-</span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="text-center">
                            <h6>„Éê„Éº„Ç∏„Éß„É≥</h6>
                            <span id="version">1.0.0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- „Çª„É≥„Çµ„Éº„Éá„Éº„Çø -->
    <div class="col-lg-8 mb-4">
        <div class="card">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0"><i class="fas fa-thermometer-half"></i> „Çª„É≥„Çµ„Éº„Éá„Éº„Çø</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <!-- Ê∏©Â∫¶ -->
                    <div class="col-md-4 mb-3">
                        <div class="sensor-card">
                            <div class="sensor-icon">
                                <i class="fas fa-thermometer-half"></i>
                            </div>
                            <div class="sensor-info">
                                <h6>Ê∏©Â∫¶</h6>
                                <div class="sensor-value" id="temperature">-</div>
                                <div class="sensor-unit">¬∞C</div>
                            </div>
                        </div>
                    </div>

                    <!-- ÊπøÂ∫¶ -->
                    <div class="col-md-4 mb-3">
                        <div class="sensor-card">
                            <div class="sensor-icon">
                                <i class="fas fa-tint"></i>
                            </div>
                            <div class="sensor-info">
                                <h6>ÊπøÂ∫¶</h6>
                                <div class="sensor-value" id="humidity">-</div>
                                <div class="sensor-unit">%</div>
                            </div>
                        </div>
                    </div>

                    <!-- ÂúüÂ£åÊ∞¥ÂàÜ -->
                    <div class="col-md-4 mb-3">
                        <div class="sensor-card">
                            <div class="sensor-icon">
                                <i class="fas fa-seedling"></i>
                            </div>
                            <div class="sensor-info">
                                <h6>ÂúüÂ£åÊ∞¥ÂàÜ</h6>
                                <div class="sensor-value" id="soil-moisture">-</div>
                                <div class="sensor-unit">-</div>
                            </div>
                        </div>
                    </div>

                    <!-- Ê∞¥„ÅÆÊÆãÈáè -->
                    <div class="col-md-6 mb-3">
                        <div class="sensor-card">
                            <div class="sensor-icon">
                                <i class="fas fa-tint"></i>
                            </div>
                            <div class="sensor-info">
                                <h6>Ê∞¥„ÅÆÊÆãÈáè</h6>
                                <div class="sensor-value" id="water-volume">-</div>
                                <div class="sensor-unit">ml</div>
                                <div class="progress mt-2">
                                    <div class="progress-bar" id="water-progress" role="progressbar"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Ê∞¥„ÅÆÊÆãÈáè„Éë„Éº„Çª„É≥„ÉÜ„Éº„Ç∏ -->
                    <div class="col-md-6 mb-3">
                        <div class="sensor-card">
                            <div class="sensor-icon">
                                <i class="fas fa-percentage"></i>
                            </div>
                            <div class="sensor-info">
                                <h6>ÊÆãÈáè</h6>
                                <div class="sensor-value" id="water-percentage">-</div>
                                <div class="sensor-unit">%</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Êìç‰Ωú„Éë„Éç„É´ -->
    <div class="col-lg-4 mb-4">
        <div class="card">
            <div class="card-header bg-warning text-dark">
                <h5 class="mb-0"><i class="fas fa-tools"></i> Êìç‰Ωú„Éë„Éç„É´</h5>
            </div>
            <div class="card-body">
                <div class="d-grid gap-2">
                    <button class="btn btn-primary" onclick="manualWatering()">
                        <i class="fas fa-tint"></i> ÊâãÂãïÁµ¶Ê∞¥
                    </button>
                    <button class="btn btn-info" onclick="capturePhoto()">
                        <i class="fas fa-camera"></i> ÂÜôÁúüÊíÆÂΩ±
                    </button>
                    <button class="btn btn-secondary" onclick="refreshData()">
                        <i class="fas fa-sync-alt"></i> „Éá„Éº„ÇøÊõ¥Êñ∞
                    </button>
                    <button class="btn btn-danger" onclick="emergencyStop()">
                        <i class="fas fa-stop"></i> Á∑äÊÄ•ÂÅúÊ≠¢
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- „Ç∞„É©„Éï -->
    <div class="col-12 mb-4">
        <div class="card">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="fas fa-chart-line"></i> „Çª„É≥„Çµ„Éº„Éá„Éº„Çø„Ç∞„É©„Éï</h5>
            </div>
            <div class="card-body">
                <canvas id="sensorChart" width="400" height="200"></canvas>
            </div>
        </div>
    </div>

    <!-- Áµ¶Ê∞¥Â±•Ê≠¥ -->
    <div class="col-12 mb-4">
        <div class="card">
            <div class="card-header bg-secondary text-white">
                <h5 class="mb-0"><i class="fas fa-history"></i> Áµ¶Ê∞¥Â±•Ê≠¥</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Êó•ÊôÇ</th>
                                <th>Á®ÆÈ°û</th>
                                <th>ÊôÇÈñì</th>
                                <th>ÂúüÂ£åÊ∞¥ÂàÜÔºàÂâçÔºâ</th>
                                <th>ÂúüÂ£åÊ∞¥ÂàÜÔºàÂæåÔºâ</th>
                                <th>Áä∂ÊÖã</th>
                            </tr>
                        </thead>
                        <tbody id="watering-history">
                            <tr>
                                <td colspan="6" class="text-center">„Éá„Éº„Çø„ÇíË™≠„ÅøËæº„Åø‰∏≠...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}
```

### üìÑ src/web/static/css/main.css
„É°„Ç§„É≥„Çπ„Çø„Ç§„É´

```css
/* „Ç´„Çπ„Çø„É†„Çπ„Çø„Ç§„É´ */
:root {
    --primary-color: #28a745;
    --secondary-color: #6c757d;
    --success-color: #28a745;
    --warning-color: #ffc107;
    --danger-color: #dc3545;
    --info-color: #17a2b8;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #f8f9fa;
}

/* „Çª„É≥„Çµ„Éº„Ç´„Éº„Éâ */
.sensor-card {
    display: flex;
    align-items: center;
    padding: 1rem;
    border: 1px solid #dee2e6;
    border-radius: 0.375rem;
    background-color: white;
    transition: box-shadow 0.15s ease-in-out;
}

.sensor-card:hover {
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
}

.sensor-icon {
    font-size: 2rem;
    color: var(--primary-color);
    margin-right: 1rem;
}

.sensor-info h6 {
    margin-bottom: 0.25rem;
    color: var(--secondary-color);
    font-size: 0.875rem;
    font-weight: 600;
}

.sensor-value {
    font-size: 1.5rem;
    font-weight: bold;
    color: var(--primary-color);
    line-height: 1;
}

.sensor-unit {
    font-size: 0.75rem;
    color: var(--secondary-color);
    margin-top: 0.25rem;
}

/* „Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥„Éê„Éº */
.navbar-brand {
    font-weight: bold;
}

.navbar-brand i {
    margin-right: 0.5rem;
}

/* „Ç´„Éº„Éâ */
.card {
    border: none;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    border-radius: 0.5rem;
}

.card-header {
    border-radius: 0.5rem 0.5rem 0 0 !important;
    border-bottom: none;
    font-weight: 600;
}

/* „Éú„Çø„É≥ */
.btn {
    border-radius: 0.375rem;
    font-weight: 500;
}

.btn i {
    margin-right: 0.5rem;
}

/* „Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº */
.progress {
    height: 0.5rem;
    border-radius: 0.25rem;
}

.progress-bar {
    border-radius: 0.25rem;
}

/* „ÉÜ„Éº„Éñ„É´ */
.table {
    margin-bottom: 0;
}

.table th {
    border-top: none;
    font-weight: 600;
    color: var(--secondary-color);
    font-size: 0.875rem;
}

/* „Ç¢„É©„Éº„Éà */
.alert {
    border: none;
    border-radius: 0.5rem;
}

/* „É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøú */
@media (max-width: 768px) {
    .sensor-card {
        flex-direction: column;
        text-align: center;
    }
    
    .sensor-icon {
        margin-right: 0;
        margin-bottom: 0.5rem;
    }
    
    .sensor-value {
        font-size: 1.25rem;
    }
}

/* „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.fade-in {
    animation: fadeIn 0.5s ease-in-out;
}

/* „Çπ„ÉÜ„Éº„Çø„Çπ„Éê„ÉÉ„Ç∏ */
.status-badge {
    font-size: 0.75rem;
    padding: 0.25rem 0.5rem;
    border-radius: 0.25rem;
}

.status-normal {
    background-color: var(--success-color);
    color: white;
}

.status-warning {
    background-color: var(--warning-color);
    color: black;
}

.status-danger {
    background-color: var(--danger-color);
    color: white;
}

/* „É≠„Éº„Éá„Ç£„É≥„Ç∞ */
.loading {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 3px solid #f3f3f3;
    border-top: 3px solid var(--primary-color);
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* „ÉÄ„Éº„ÇØ„É¢„Éº„ÉâÂØæÂøú */
@media (prefers-color-scheme: dark) {
    body {
        background-color: #212529;
        color: #f8f9fa;
    }
    
    .card {
        background-color: #343a40;
        border-color: #495057;
    }
    
    .sensor-card {
        background-color: #343a40;
        border-color: #495057;
    }
    
    .table {
        color: #f8f9fa;
    }
    
    .table th {
        color: #adb5bd;
    }
}
```

### üìÑ src/web/static/js/main.js
„É°„Ç§„É≥JavaScript

```javascript
// „Ç∞„É≠„Éº„Éê„É´Â§âÊï∞
let socket;
let sensorChart;
let isConnected = false;

// DOMË™≠„ÅøËæº„ÅøÂÆå‰∫ÜÂæå„Å´ÂÆüË°å
document.addEventListener('DOMContentLoaded', function() {
    initializeWebSocket();
    initializeEventListeners();
    startDataRefresh();
});

// WebSocketÂàùÊúüÂåñ
function initializeWebSocket() {
    try {
        socket = io();
        
        socket.on('connect', function() {
            isConnected = true;
            updateConnectionStatus(true);
            console.log('WebSocketÊé•Á∂ö„ÅåÁ¢∫Á´ã„Åï„Çå„Åæ„Åó„Åü');
        });
        
        socket.on('disconnect', function() {
            isConnected = false;
            updateConnectionStatus(false);
            console.log('WebSocketÊé•Á∂ö„ÅåÂàáÊñ≠„Åï„Çå„Åæ„Åó„Åü');
        });
        
        socket.on('sensor_data', function(data) {
            updateSensorDisplay(data);
        });
        
        socket.on('watering_status', function(data) {
            updateWateringStatus(data);
        });
        
    } catch (error) {
        console.error('WebSocketÂàùÊúüÂåñ„Ç®„É©„Éº:', error);
        updateConnectionStatus(false);
    }
}

// „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºÂàùÊúüÂåñ
function initializeEventListeners() {
    // „Éá„Éº„ÇøÊõ¥Êñ∞„Éú„Çø„É≥
    const refreshBtn = document.getElementById('refresh-btn');
    if (refreshBtn) {
        refreshBtn.addEventListener('click', refreshData);
    }
    
    // ÊâãÂãïÁµ¶Ê∞¥„Éú„Çø„É≥
    const wateringBtn = document.getElementById('watering-btn');
    if (wateringBtn) {
        wateringBtn.addEventListener('click', manualWatering);
    }
    
    // ÂÜôÁúüÊíÆÂΩ±„Éú„Çø„É≥
    const photoBtn = document.getElementById('photo-btn');
    if (photoBtn) {
        photoBtn.addEventListener('click', capturePhoto);
    }
}

// „Éá„Éº„ÇøÊõ¥Êñ∞ÈñãÂßã
function startDataRefresh() {
    // ÂàùÂõû„Éá„Éº„ÇøÂèñÂæó
    refreshData();
    
    // 30Áßí„Åî„Å®„Å´„Éá„Éº„ÇøÊõ¥Êñ∞
    setInterval(refreshData, 30000);
}

// „Çª„É≥„Çµ„Éº„Éá„Éº„ÇøÂèñÂæó
async function refreshData() {
    try {
        showLoading(true);
        
        // „Çª„É≥„Çµ„Éº„Éá„Éº„Çø„ÇíÂèñÂæó
        const sensorResponse = await fetch('/api/sensors/');
        const sensorData = await sensorResponse.json();
        
        if (sensorData.status === 'success') {
            updateSensorDisplay(sensorData.data);
        }
        
        // Áµ¶Ê∞¥Â±•Ê≠¥„ÇíÂèñÂæó
        await loadWateringHistory();
        
        // „Ç∑„Çπ„ÉÜ„É†„Çπ„ÉÜ„Éº„Çø„Çπ„ÇíÊõ¥Êñ∞
        updateSystemStatus();
        
    } catch (error) {
        console.error('„Éá„Éº„ÇøÊõ¥Êñ∞„Ç®„É©„Éº:', error);
        showAlert('„Éá„Éº„Çø„ÅÆÊõ¥Êñ∞„Å´Â§±Êïó„Åó„Åæ„Åó„Åü', 'danger');
    } finally {
        showLoading(false);
    }
}

// „Çª„É≥„Çµ„ÉºË°®Á§∫Êõ¥Êñ∞
function updateSensorDisplay(data) {
    // Ê∏©Â∫¶
    updateSensorValue('temperature', data.temperature, '¬∞C');
    
    // ÊπøÂ∫¶
    updateSensorValue('humidity', data.humidity, '%');
    
    // ÂúüÂ£åÊ∞¥ÂàÜ
    updateSensorValue('soil-moisture', data.soil_moisture, '');
    
    // Ê∞¥„ÅÆÊÆãÈáè
    updateSensorValue('water-volume', data.water_volume, 'ml');
    updateSensorValue('water-percentage', data.water_percentage, '%');
    
    // Ê∞¥„ÅÆÊÆãÈáè„Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº
    updateWaterProgress(data.water_percentage);
    
    // ÊúÄÁµÇÊõ¥Êñ∞ÊôÇÂàª
    updateLastUpdateTime();
}

// „Çª„É≥„Çµ„ÉºÂÄ§Êõ¥Êñ∞
function updateSensorValue(elementId, value, unit) {
    const element = document.getElementById(elementId);
    if (element) {
        if (value !== null && value !== undefined) {
            element.textContent = value.toFixed(1);
            element.parentElement.classList.add('fade-in');
            
            // „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Âæå„Å´„ÇØ„É©„Çπ„ÇíÂâäÈô§
            setTimeout(() => {
                element.parentElement.classList.remove('fade-in');
            }, 500);
        } else {
            element.textContent = '-';
        }
    }
}

// Ê∞¥„ÅÆÊÆãÈáè„Éó„É≠„Ç∞„É¨„Çπ„Éê„ÉºÊõ¥Êñ∞
function updateWaterProgress(percentage) {
    const progressBar = document.getElementById('water-progress');
    if (progressBar && percentage !== null) {
        progressBar.style.width = percentage + '%';
        
        // Ëâ≤„ÇíÂ§âÊõ¥
        progressBar.className = 'progress-bar';
        if (percentage > 50) {
            progressBar.classList.add('bg-success');
        } else if (percentage > 20) {
            progressBar.classList.add('bg-warning');
        } else {
            progressBar.classList.add('bg-danger');
        }
    }
}

// ÊâãÂãïÁµ¶Ê∞¥ÂÆüË°å
async function manualWatering() {
    try {
        const duration = prompt('Áµ¶Ê∞¥ÊôÇÈñìÔºàÁßíÔºâ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ:', '5');
        if (!duration || isNaN(duration)) {
            return;
        }
        
        showLoading(true);
        
        const response = await fetch('/api/watering/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                duration: parseInt(duration)
            })
        });
        
        const result = await response.json();
        
        if (result.status === 'success') {
            showAlert('Áµ¶Ê∞¥„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„Åü', 'success');
            await loadWateringHistory(); // Â±•Ê≠¥„ÇíÊõ¥Êñ∞
        } else {
            showAlert('Áµ¶Ê∞¥„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + result.message, 'danger');
        }
        
    } catch (error) {
        console.error('Áµ¶Ê∞¥„Ç®„É©„Éº:', error);
        showAlert('Áµ¶Ê∞¥„ÅÆÂÆüË°å„Å´Â§±Êïó„Åó„Åæ„Åó„Åü', 'danger');
    } finally {
        showLoading(false);
    }
}

// ÂÜôÁúüÊíÆÂΩ±
async function capturePhoto() {
    try {
        showLoading(true);
        
        const response = await fetch('/api/camera/capture', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                save: true
            })
        });
        
        const result = await response.json();
        
        if (result.status === 'success') {
            showAlert('ÂÜôÁúü„ÇíÊíÆÂΩ±„Åó„Åæ„Åó„Åü', 'success');
        } else {
            showAlert('ÂÜôÁúüÊíÆÂΩ±„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + result.message, 'danger');
        }
        
    } catch (error) {
        console.error('ÂÜôÁúüÊíÆÂΩ±„Ç®„É©„Éº:', error);
        showAlert('ÂÜôÁúüÊíÆÂΩ±„Å´Â§±Êïó„Åó„Åæ„Åó„Åü', 'danger');
    } finally {
        showLoading(false);
    }
}

// Áµ¶Ê∞¥Â±•Ê≠¥Ë™≠„ÅøËæº„Åø
async function loadWateringHistory() {
    try {
        const response = await fetch('/api/watering/history?days=7');
        const result = await response.json();
        
        if (result.status === 'success') {
            updateWateringHistoryTable(result.data);
        }
        
    } catch (error) {
        console.error('Áµ¶Ê∞¥Â±•Ê≠¥Ë™≠„ÅøËæº„Åø„Ç®„É©„Éº:', error);
    }
}

// Áµ¶Ê∞¥Â±•Ê≠¥„ÉÜ„Éº„Éñ„É´Êõ¥Êñ∞
function updateWateringHistoryTable(history) {
    const tbody = document.getElementById('watering-history');
    if (!tbody) return;
    
    if (history.length === 0) {
        tbody.innerHTML = '<tr><td colspan="6" class="text-center">Áµ¶Ê∞¥Â±•Ê≠¥„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</td></tr>';
        return;
    }
    
    tbody.innerHTML = history.map(record => `
        <tr>
            <td>${formatDateTime(record.timestamp)}</td>
            <td>
                <span class="badge ${record.manual ? 'bg-warning' : 'bg-info'}">
                    ${record.manual ? 'ÊâãÂãï' : 'Ëá™Âãï'}
                </span>
            </td>
            <td>${record.duration}Áßí</td>
            <td>${record.soil_moisture_before || '-'}</td>
            <td>${record.soil_moisture_after || '-'}</td>
            <td>
                <span class="badge ${record.success ? 'bg-success' : 'bg-danger'}">
                    ${record.success ? 'ÊàêÂäü' : 'Â§±Êïó'}
                </span>
            </td>
        </tr>
    `).join('');
}

// „Ç∑„Çπ„ÉÜ„É†„Çπ„ÉÜ„Éº„Çø„ÇπÊõ¥Êñ∞
function updateSystemStatus() {
    const statusElement = document.getElementById('system-status');
    if (statusElement) {
        statusElement.textContent = isConnected ? 'Á®ºÂÉç‰∏≠' : 'Êé•Á∂ö„Ç®„É©„Éº';
        statusElement.className = `badge ${isConnected ? 'bg-success' : 'bg-danger'}`;
    }
}

// Êé•Á∂ö„Çπ„ÉÜ„Éº„Çø„ÇπÊõ¥Êñ∞
function updateConnectionStatus(connected) {
    isConnected = connected;
    updateSystemStatus();
    
    // Êé•Á∂öÁä∂ÊÖã„Å´Âøú„Åò„Å¶UI„ÇíÊõ¥Êñ∞
    const elements = document.querySelectorAll('[data-requires-connection]');
    elements.forEach(element => {
        element.disabled = !connected;
    });
}

// ÊúÄÁµÇÊõ¥Êñ∞ÊôÇÂàªÊõ¥Êñ∞
function updateLastUpdateTime() {
    const element = document.getElementById('last-update');
    if (element) {
        element.textContent = new Date().toLocaleString();
    }
}

// „É≠„Éº„Éá„Ç£„É≥„Ç∞Ë°®Á§∫
function showLoading(show) {
    const loadingElements = document.querySelectorAll('.loading');
    loadingElements.forEach(element => {
        element.style.display = show ? 'inline-block' : 'none';
    });
}

// „Ç¢„É©„Éº„ÉàË°®Á§∫
function showAlert(message, type = 'info') {
    const alertContainer = document.getElementById('alert-container') || createAlertContainer();
    
    const alertId = 'alert-' + Date.now();
    const alertHTML = `
        <div id="${alertId}" class="alert alert-${type} alert-dismissible fade show" role="alert">
            ${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
    `;
    
    alertContainer.insertAdjacentHTML('beforeend', alertHTML);
    
    // 5ÁßíÂæå„Å´Ëá™Âãï„ÅßÂâäÈô§
    setTimeout(() => {
        const alert = document.getElementById(alertId);
        if (alert) {
            alert.remove();
        }
    }, 5000);
}

// „Ç¢„É©„Éº„Éà„Ç≥„É≥„ÉÜ„Éä‰ΩúÊàê
function createAlertContainer() {
    const container = document.createElement('div');
    container.id = 'alert-container';
    container.className = 'position-fixed top-0 end-0 p-3';
    container.style.zIndex = '1050';
    document.body.appendChild(container);
    return container;
}

// Êó•ÊôÇ„Éï„Ç©„Éº„Éû„ÉÉ„Éà
function formatDateTime(timestamp) {
    const date = new Date(timestamp);
    return date.toLocaleString('ja-JP');
}

// Á∑äÊÄ•ÂÅúÊ≠¢
async function emergencyStop() {
    if (!confirm('Á∑äÊÄ•ÂÅúÊ≠¢„ÇíÂÆüË°å„Åó„Åæ„Åô„ÅãÔºü')) {
        return;
    }
    
    try {
        showLoading(true);
        
        const response = await fetch('/api/watering/stop', {
            method: 'POST'
        });
        
        const result = await response.json();
        
        if (result.status === 'success') {
            showAlert('Á∑äÊÄ•ÂÅúÊ≠¢„ÇíÂÆüË°å„Åó„Åæ„Åó„Åü', 'warning');
        } else {
            showAlert('Á∑äÊÄ•ÂÅúÊ≠¢„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + result.message, 'danger');
        }
        
    } catch (error) {
        console.error('Á∑äÊÄ•ÂÅúÊ≠¢„Ç®„É©„Éº:', error);
        showAlert('Á∑äÊÄ•ÂÅúÊ≠¢„Å´Â§±Êïó„Åó„Åæ„Åó„Åü', 'danger');
    } finally {
        showLoading(false);
    }
}
```

### üìÑ src/web/static/js/dashboard.js
„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„ÉâÂ∞ÇÁî®JavaScript

```javascript
// „ÉÅ„É£„Éº„ÉàÂàùÊúüÂåñ
function initializeChart() {
    const ctx = document.getElementById('sensorChart');
    if (!ctx) return;
    
    sensorChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: [],
            datasets: [
                {
                    label: 'Ê∏©Â∫¶ (¬∞C)',
                    data: [],
                    borderColor: 'rgb(255, 99, 132)',
                    backgroundColor: 'rgba(255, 99, 132, 0.2)',
                    tension: 0.1
                },
                {
                    label: 'ÊπøÂ∫¶ (%)',
                    data: [],
                    borderColor: 'rgb(54, 162, 235)',
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    tension: 0.1
                },
                {
                    label: 'ÂúüÂ£åÊ∞¥ÂàÜ',
                    data: [],
                    borderColor: 'rgb(75, 192, 192)',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    tension: 0.1
                }
            ]
        },
        options: {
            responsive: true,
            scales: {
                y: {
                    beginAtZero: true
                }
            },
            plugins: {
                legend: {
                    display: true
                }
            }
        }
    });
}

// „ÉÅ„É£„Éº„Éà„Éá„Éº„ÇøÊõ¥Êñ∞
function updateChart(data) {
    if (!sensorChart) return;
    
    const now = new Date().toLocaleTimeString();
    
    // „Éá„Éº„Çø„ÇíËøΩÂä†
    sensorChart.data.labels.push(now);
    sensorChart.data.datasets[0].data.push(data.temperature);
    sensorChart.data.datasets[1].data.push(data.humidity);
    sensorChart.data.datasets[2].data.push(data.soil_moisture);
    
    // ÊúÄÂ§ß20ÂÄã„ÅÆ„Éá„Éº„Çø„Éù„Ç§„É≥„Éà„Çí‰øùÊåÅ
    if (sensorChart.data.labels.length > 20) {
        sensorChart.data.labels.shift();
        sensorChart.data.datasets.forEach(dataset => {
            dataset.data.shift();
        });
    }
    
    sensorChart.update();
}

// „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„ÉâÂàùÊúüÂåñ
document.addEventListener('DOMContentLoaded', function() {
    initializeChart();
    
    // „ÉÅ„É£„Éº„ÉàÊõ¥Êñ∞„Çí„É°„Ç§„É≥„ÅÆ„Éá„Éº„ÇøÊõ¥Êñ∞„Å´Áµ±Âêà
    const originalUpdateSensorDisplay = window.updateSensorDisplay;
    window.updateSensorDisplay = function(data) {
        originalUpdateSensorDisplay(data);
        updateChart(data);
    };
});
```

## üß™ „ÉÜ„Çπ„ÉàÊñπÊ≥ï

### 1. „ÉÜ„É≥„Éó„É¨„Éº„Éà„ÉÜ„Çπ„Éà
```bash
# ‰ªÆÊÉ≥Áí∞Â¢É„Çí„Ç¢„ÇØ„ÉÜ„Ç£„Éô„Éº„Éà
source venv/bin/activate

# Flask„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥Ëµ∑Âãï
python main.py

# „Éñ„É©„Ç¶„Ç∂„Åß„Ç¢„ÇØ„Çª„Çπ
# http://localhost:5000
```

### 2. „É¨„Çπ„Éù„É≥„Ç∑„Éñ„ÉÜ„Çπ„Éà
- „Éá„Çπ„ÇØ„Éà„ÉÉ„Éó„Éñ„É©„Ç¶„Ç∂„ÅßË°®Á§∫Á¢∫Ë™ç
- „É¢„Éê„Ç§„É´„Éñ„É©„Ç¶„Ç∂„ÅßË°®Á§∫Á¢∫Ë™ç
- „Çø„Éñ„É¨„ÉÉ„Éà„Éñ„É©„Ç¶„Ç∂„ÅßË°®Á§∫Á¢∫Ë™ç

### 3. Ê©üËÉΩ„ÉÜ„Çπ„Éà
- „Çª„É≥„Çµ„Éº„Éá„Éº„Çø„ÅÆË°®Á§∫Á¢∫Ë™ç
- ÊâãÂãïÁµ¶Ê∞¥„Éú„Çø„É≥„ÅÆÂãï‰ΩúÁ¢∫Ë™ç
- ÂÜôÁúüÊíÆÂΩ±„Éú„Çø„É≥„ÅÆÂãï‰ΩúÁ¢∫Ë™ç
- „Éá„Éº„ÇøÊõ¥Êñ∞„Éú„Çø„É≥„ÅÆÂãï‰ΩúÁ¢∫Ë™ç

---

**‰ΩúÊàêÊó•**: 2025Âπ¥1Êúà
**„Éê„Éº„Ç∏„Éß„É≥**: 1.0
**„ÉÅ„Éº„É†**: KEBABS

