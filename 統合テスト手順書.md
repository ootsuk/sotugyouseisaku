# çµ±åˆãƒ†ã‚¹ãƒˆæ‰‹é †æ›¸
## ã™ãã™ããƒŸãƒ³ãƒˆã¡ã‚ƒã‚“ - å…¨ã‚·ã‚¹ãƒ†ãƒ çµ±åˆãƒ†ã‚¹ãƒˆ

---

## ğŸ“‹ æ¦‚è¦
ã‚¹ãƒãƒ¼ãƒˆãƒ—ãƒ©ãƒ³ã‚¿ãƒ¼ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®çµ±åˆãƒ†ã‚¹ãƒˆæ‰‹é †æ›¸ã€‚å„æ©Ÿèƒ½ã®é€£æºå‹•ä½œã¨ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®å®‰å®šæ€§ã‚’ç¢ºèª

## ğŸ¯ ãƒ†ã‚¹ãƒˆç›®æ¨™
- å…¨æ©Ÿèƒ½ã®æ­£å¸¸å‹•ä½œç¢ºèª
- ã‚·ã‚¹ãƒ†ãƒ é–“ã®é€£æºå‹•ä½œç¢ºèª
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ç¢ºèª
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
- é•·æœŸç¨¼åƒãƒ†ã‚¹ãƒˆ

---

## ğŸ› ï¸ ãƒ†ã‚¹ãƒˆç’°å¢ƒ

### å¿…è¦ãªç’°å¢ƒ
- Raspberry Pi 5
- å…¨ã‚»ãƒ³ã‚µãƒ¼ï¼ˆAHT25, SEN0193, ãƒ•ãƒ­ãƒ¼ãƒˆã‚¹ã‚¤ãƒƒãƒï¼‰
- ãƒªãƒ¬ãƒ¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ»æ°´ãƒãƒ³ãƒ—
- USBã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
- ã‚«ãƒ¡ãƒ©ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç’°å¢ƒ

### ãƒ†ã‚¹ãƒˆç”¨æ¤ç‰©
- ãƒŸãƒ³ãƒˆï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰
- ãƒ—ãƒ©ãƒ³ã‚¿ãƒ¼ãƒ»åœŸãƒ»æ°´

---

## ğŸ”§ ãƒ†ã‚¹ãƒˆæ‰‹é †

### Phase 1: å€‹åˆ¥æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ

#### 1.1 ã‚»ãƒ³ã‚µãƒ¼ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ
```bash
# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
cd /home/pi/smart-planter
python test_sensors.py

# æœŸå¾…ã•ã‚Œã‚‹çµæœ
âœ… AHT25ã‚»ãƒ³ã‚µãƒ¼åˆæœŸåŒ–å®Œäº†
âœ… SEN0193ã‚»ãƒ³ã‚µãƒ¼åˆæœŸåŒ–å®Œäº†
âœ… ãƒ•ãƒ­ãƒ¼ãƒˆã‚¹ã‚¤ãƒƒãƒåˆæœŸåŒ–å®Œäº†
âœ… æ¸©æ¹¿åº¦ãƒ‡ãƒ¼ã‚¿å–å¾—: æ¸©åº¦=25.5Â°C, æ¹¿åº¦=60.0%
âœ… åœŸå£Œæ°´åˆ†ãƒ‡ãƒ¼ã‚¿å–å¾—: 45.2%
âœ… æ°´ä½ãƒ‡ãƒ¼ã‚¿å–å¾—: æº€æ°´
```

#### 1.2 çµ¦æ°´ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ
```bash
# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
python test_watering.py

# æœŸå¾…ã•ã‚Œã‚‹çµæœ
âœ… çµ¦æ°´ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹æ­£å¸¸
âœ… æ‰‹å‹•çµ¦æ°´ãƒ†ã‚¹ãƒˆæˆåŠŸ
âœ… è¨­å®šæ›´æ–°ãƒ†ã‚¹ãƒˆæˆåŠŸ
âœ… è‡ªå‹•çµ¦æ°´ãƒ†ã‚¹ãƒˆæˆåŠŸ
âœ… çµ¦æ°´å±¥æ­´è¨˜éŒ²æ­£å¸¸
```

#### 1.3 LINEé€šçŸ¥ãƒ†ã‚¹ãƒˆ
```bash
# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
python test_line_notify.py

# æœŸå¾…ã•ã‚Œã‚‹çµæœ
âœ… åŸºæœ¬ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ã‚¹ãƒˆæˆåŠŸ
âœ… æ°´ã‚„ã‚Šé€šçŸ¥ãƒ†ã‚¹ãƒˆæˆåŠŸ
âœ… ã‚»ãƒ³ã‚µãƒ¼ã‚¢ãƒ©ãƒ¼ãƒˆãƒ†ã‚¹ãƒˆæˆåŠŸ
âœ… LINEé€šçŸ¥é€ä¿¡å®Œäº†
```

#### 1.4 ãƒ‡ãƒ¼ã‚¿ç®¡ç†ãƒ†ã‚¹ãƒˆ
```bash
# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
python test_data_management.py

# æœŸå¾…ã•ã‚Œã‚‹çµæœ
âœ… ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ä¿å­˜æˆåŠŸ
âœ… çµ¦æ°´è¨˜éŒ²ä¿å­˜æˆåŠŸ
âœ… ãƒ‡ãƒ¼ã‚¿å–å¾—æˆåŠŸ
âœ… ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æƒ…å ±å–å¾—æˆåŠŸ
âœ… ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä½œæˆæˆåŠŸ
```

### Phase 2: çµ±åˆãƒ†ã‚¹ãƒˆ

#### 2.1 ã‚·ã‚¹ãƒ†ãƒ çµ±åˆãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```python
# test_integration.py
import time
import logging
import threading
from datetime import datetime
from src.sensors.sensor_manager import SensorManager
from src.watering.auto_watering_manager import AutoWateringManager
from src.notifications.line_notify import LineNotify
from src.data.data_manager_service import DataManagerService
from src.camera.camera_controller import CameraController

# ãƒ­ã‚°è¨­å®š
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)

class IntegrationTester:
    """çµ±åˆãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹"""
    
    def __init__(self):
        self.logger = logging.getLogger("integration_tester")
        self.test_results = {}
        self.systems = {}
        
    def setup_systems(self):
        """ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–"""
        try:
            print("ğŸ”§ ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ä¸­...")
            
            # ãƒ‡ãƒ¼ã‚¿ç®¡ç†ã‚µãƒ¼ãƒ“ã‚¹
            self.systems['data_manager'] = DataManagerService()
            self.systems['data_manager'].start_service()
            
            # ã‚»ãƒ³ã‚µãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
            self.systems['sensor_manager'] = SensorManager(self.systems['data_manager'])
            
            # LINEé€šçŸ¥
            self.systems['line_notify'] = LineNotify()
            
            # è‡ªå‹•çµ¦æ°´ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼
            self.systems['auto_watering'] = AutoWateringManager(
                self.systems['sensor_manager'], 
                self.systems['line_notify']
            )
            
            # ã‚«ãƒ¡ãƒ©ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼
            self.systems['camera'] = CameraController()
            
            print("âœ… å…¨ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº†")
            return True
            
        except Exception as e:
            print(f"âŒ ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: {str(e)}")
            return False
    
    def test_sensor_integration(self):
        """ã‚»ãƒ³ã‚µãƒ¼çµ±åˆãƒ†ã‚¹ãƒˆ"""
        print("\nğŸ“Š ã‚»ãƒ³ã‚µãƒ¼çµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹")
        
        try:
            # ã‚»ãƒ³ã‚µãƒ¼ç›£è¦–é–‹å§‹
            self.systems['sensor_manager'].start_monitoring()
            
            # 30ç§’é–“ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ†ã‚¹ãƒˆ
            for i in range(6):
                time.sleep(5)
                data = self.systems['sensor_manager'].get_latest_data()
                print(f"5ç§’å¾Œ: {data}")
                
                # ãƒ‡ãƒ¼ã‚¿ä¿å­˜ç¢ºèª
                if data:
                    self.test_results['sensor_data_save'] = True
            
            self.systems['sensor_manager'].stop_monitoring()
            self.test_results['sensor_integration'] = True
            print("âœ… ã‚»ãƒ³ã‚µãƒ¼çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†")
            
        except Exception as e:
            print(f"âŒ ã‚»ãƒ³ã‚µãƒ¼çµ±åˆãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: {str(e)}")
            self.test_results['sensor_integration'] = False
    
    def test_watering_integration(self):
        """çµ¦æ°´çµ±åˆãƒ†ã‚¹ãƒˆ"""
        print("\nğŸ’§ çµ¦æ°´çµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹")
        
        try:
            # è‡ªå‹•çµ¦æ°´é–‹å§‹
            self.systems['auto_watering'].start_auto_watering()
            
            # æ‰‹å‹•çµ¦æ°´ãƒ†ã‚¹ãƒˆ
            result = self.systems['auto_watering'].manual_watering()
            print(f"æ‰‹å‹•çµ¦æ°´çµæœ: {result}")
            
            if result['success']:
                self.test_results['manual_watering'] = True
                
                # LINEé€šçŸ¥ç¢ºèª
                time.sleep(2)
                self.test_results['watering_notification'] = True
            
            # çµ¦æ°´å±¥æ­´ç¢ºèª
            history = self.systems['auto_watering'].watering_controller.get_recent_history(1)
            if history:
                self.test_results['watering_history'] = True
            
            self.systems['auto_watering'].stop_auto_watering()
            self.test_results['watering_integration'] = True
            print("âœ… çµ¦æ°´çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†")
            
        except Exception as e:
            print(f"âŒ çµ¦æ°´çµ±åˆãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: {str(e)}")
            self.test_results['watering_integration'] = False
    
    def test_camera_integration(self):
        """ã‚«ãƒ¡ãƒ©çµ±åˆãƒ†ã‚¹ãƒˆ"""
        print("\nğŸ“¸ ã‚«ãƒ¡ãƒ©çµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹")
        
        try:
            # æ’®å½±ãƒ†ã‚¹ãƒˆ
            result = self.systems['camera'].capture_image()
            print(f"æ’®å½±çµæœ: {result}")
            
            if result['success']:
                self.test_results['camera_capture'] = True
                
                # ç”»åƒä¿å­˜ç¢ºèª
                if result.get('filepath'):
                    self.test_results['image_save'] = True
            
            self.test_results['camera_integration'] = True
            print("âœ… ã‚«ãƒ¡ãƒ©çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†")
            
        except Exception as e:
            print(f"âŒ ã‚«ãƒ¡ãƒ©çµ±åˆãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: {str(e)}")
            self.test_results['camera_integration'] = False
    
    def test_data_flow(self):
        """ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆ"""
        print("\nğŸ”„ ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆé–‹å§‹")
        
        try:
            # ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ â†’ ãƒ‡ãƒ¼ã‚¿ä¿å­˜
            sensor_data = self.systems['sensor_manager'].get_latest_data()
            if sensor_data:
                save_result = self.systems['data_manager'].save_sensor_data(sensor_data)
                if save_result:
                    self.test_results['sensor_data_flow'] = True
            
            # çµ¦æ°´è¨˜éŒ² â†’ ãƒ‡ãƒ¼ã‚¿ä¿å­˜
            watering_record = {
                'timestamp': datetime.now().isoformat(),
                'soil_moisture': 45.0,
                'duration_seconds': 5,
                'water_amount_ml': 100,
                'success': True
            }
            save_result = self.systems['data_manager'].save_watering_record(watering_record)
            if save_result:
                self.test_results['watering_data_flow'] = True
            
            # ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ†ã‚¹ãƒˆ
            sensor_history = self.systems['data_manager'].get_sensor_data(1)
            watering_history = self.systems['data_manager'].get_watering_history(1)
            
            if sensor_history and watering_history:
                self.test_results['data_retrieval'] = True
            
            self.test_results['data_flow'] = True
            print("âœ… ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆå®Œäº†")
            
        except Exception as e:
            print(f"âŒ ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: {str(e)}")
            self.test_results['data_flow'] = False
    
    def test_error_handling(self):
        """ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆ"""
        print("\nâš ï¸ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆé–‹å§‹")
        
        try:
            # ã‚»ãƒ³ã‚µãƒ¼ã‚¨ãƒ©ãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            # ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€ã‚»ãƒ³ã‚µãƒ¼ã‚’ä¸€æ™‚çš„ã«ç„¡åŠ¹åŒ–ï¼‰
            
            # çµ¦æ°´ã‚¨ãƒ©ãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            # ï¼ˆæ°´ã‚¿ãƒ³ã‚¯ç©ºã®çŠ¶æ…‹ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆï¼‰
            
            # LINEé€šçŸ¥ã‚¨ãƒ©ãƒ¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
            # ï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯åˆ‡æ–­ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆï¼‰
            
            self.test_results['error_handling'] = True
            print("âœ… ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆå®Œäº†")
            
        except Exception as e:
            print(f"âŒ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: {str(e)}")
            self.test_results['error_handling'] = False
    
    def test_performance(self):
        """ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ"""
        print("\nâš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆé–‹å§‹")
        
        try:
            start_time = time.time()
            
            # å¤§é‡ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ†ã‚¹ãƒˆ
            for i in range(100):
                test_data = {
                    'temperature_humidity': {'temperature': 25.0 + i*0.1, 'humidity': 60.0},
                    'soil_moisture': {'moisture_percentage': 45.0 + i*0.1},
                    'water_level': {'is_water_available': True}
                }
                self.systems['data_manager'].save_sensor_data(test_data)
            
            end_time = time.time()
            processing_time = end_time - start_time
            
            print(f"100ä»¶ãƒ‡ãƒ¼ã‚¿å‡¦ç†æ™‚é–“: {processing_time:.2f}ç§’")
            
            if processing_time < 10:  # 10ç§’ä»¥å†…
                self.test_results['performance'] = True
            
            print("âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Œäº†")
            
        except Exception as e:
            print(f"âŒ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: {str(e)}")
            self.test_results['performance'] = False
    
    def cleanup_systems(self):
        """ã‚·ã‚¹ãƒ†ãƒ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—"""
        try:
            print("\nğŸ§¹ ã‚·ã‚¹ãƒ†ãƒ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ä¸­...")
            
            if 'auto_watering' in self.systems:
                self.systems['auto_watering'].stop_auto_watering()
            
            if 'sensor_manager' in self.systems:
                self.systems['sensor_manager'].stop_monitoring()
            
            if 'data_manager' in self.systems:
                self.systems['data_manager'].stop_service()
            
            print("âœ… ã‚·ã‚¹ãƒ†ãƒ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—å®Œäº†")
            
        except Exception as e:
            print(f"âŒ ã‚·ã‚¹ãƒ†ãƒ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚¨ãƒ©ãƒ¼: {str(e)}")
    
    def generate_report(self):
        """ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ"""
        print("\nğŸ“‹ ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆ")
        print("=" * 50)
        
        total_tests = len(self.test_results)
        passed_tests = sum(1 for result in self.test_results.values() if result)
        failed_tests = total_tests - passed_tests
        
        print(f"ç·ãƒ†ã‚¹ãƒˆæ•°: {total_tests}")
        print(f"æˆåŠŸ: {passed_tests}")
        print(f"å¤±æ•—: {failed_tests}")
        print(f"æˆåŠŸç‡: {(passed_tests/total_tests)*100:.1f}%")
        
        print("\nè©³ç´°çµæœ:")
        for test_name, result in self.test_results.items():
            status = "âœ… PASS" if result else "âŒ FAIL"
            print(f"  {test_name}: {status}")
        
        # ãƒ¬ãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜
        report_file = f"/mnt/usb-storage/test_report_{datetime.now().strftime('%Y%m%d_%H%M%S')}.txt"
        try:
            with open(report_file, 'w', encoding='utf-8') as f:
                f.write(f"çµ±åˆãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆ\n")
                f.write(f"å®Ÿè¡Œæ—¥æ™‚: {datetime.now().isoformat()}\n")
                f.write(f"ç·ãƒ†ã‚¹ãƒˆæ•°: {total_tests}\n")
                f.write(f"æˆåŠŸ: {passed_tests}\n")
                f.write(f"å¤±æ•—: {failed_tests}\n")
                f.write(f"æˆåŠŸç‡: {(passed_tests/total_tests)*100:.1f}%\n\n")
                
                f.write("è©³ç´°çµæœ:\n")
                for test_name, result in self.test_results.items():
                    status = "PASS" if result else "FAIL"
                    f.write(f"  {test_name}: {status}\n")
            
            print(f"\nğŸ“„ ãƒ¬ãƒãƒ¼ãƒˆä¿å­˜: {report_file}")
            
        except Exception as e:
            print(f"âŒ ãƒ¬ãƒãƒ¼ãƒˆä¿å­˜ã‚¨ãƒ©ãƒ¼: {str(e)}")
    
    def run_all_tests(self):
        """å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ"""
        print("ğŸŒ± ã™ãã™ããƒŸãƒ³ãƒˆã¡ã‚ƒã‚“çµ±åˆãƒ†ã‚¹ãƒˆé–‹å§‹")
        print("=" * 50)
        
        # ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
        if not self.setup_systems():
            print("âŒ ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å¤±æ•—")
            return
        
        try:
            # å„ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
            self.test_sensor_integration()
            self.test_watering_integration()
            self.test_camera_integration()
            self.test_data_flow()
            self.test_error_handling()
            self.test_performance()
            
        finally:
            # ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
            self.cleanup_systems()
            
            # ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
            self.generate_report()
        
        print("\nğŸ‰ çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†")

def main():
    """ãƒ¡ã‚¤ãƒ³å®Ÿè¡Œ"""
    tester = IntegrationTester()
    tester.run_all_tests()

if __name__ == "__main__":
    main()
```

### Phase 3: é•·æœŸç¨¼åƒãƒ†ã‚¹ãƒˆ

#### 3.1 é•·æœŸç¨¼åƒãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```python
# test_long_term.py
import time
import logging
from datetime import datetime, timedelta
from src.app import init_systems

def long_term_test():
    """é•·æœŸç¨¼åƒãƒ†ã‚¹ãƒˆï¼ˆ24æ™‚é–“ï¼‰"""
    print("ğŸ• é•·æœŸç¨¼åƒãƒ†ã‚¹ãƒˆé–‹å§‹ï¼ˆ24æ™‚é–“ï¼‰")
    
    # ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
    init_systems()
    
    start_time = datetime.now()
    end_time = start_time + timedelta(hours=24)
    
    test_interval = 3600  # 1æ™‚é–“é–“éš”ã§ãƒã‚§ãƒƒã‚¯
    check_count = 0
    
    try:
        while datetime.now() < end_time:
            check_count += 1
            current_time = datetime.now()
            elapsed_hours = (current_time - start_time).total_seconds() / 3600
            
            print(f"\nâ° ãƒã‚§ãƒƒã‚¯ {check_count} ({elapsed_hours:.1f}æ™‚é–“çµŒé)")
            
            # ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ãƒã‚§ãƒƒã‚¯
            # - ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿å–å¾—
            # - çµ¦æ°´ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹
            # - ãƒ‡ãƒ¼ã‚¿ä¿å­˜çŠ¶æ³
            # - ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä½¿ç”¨é‡
            # - ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
            
            time.sleep(test_interval)
        
        print("âœ… é•·æœŸç¨¼åƒãƒ†ã‚¹ãƒˆå®Œäº†ï¼ˆ24æ™‚é–“ï¼‰")
        
    except KeyboardInterrupt:
        print("\nâ¹ï¸ é•·æœŸç¨¼åƒãƒ†ã‚¹ãƒˆä¸­æ–­")
    except Exception as e:
        print(f"âŒ é•·æœŸç¨¼åƒãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: {str(e)}")
```

### Phase 4: è² è·ãƒ†ã‚¹ãƒˆ

#### 4.1 è² è·ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ
```python
# test_load.py
import threading
import time
import random
from src.sensors.sensor_manager import SensorManager
from src.data.data_manager_service import DataManagerService

def load_test():
    """è² è·ãƒ†ã‚¹ãƒˆ"""
    print("âš¡ è² è·ãƒ†ã‚¹ãƒˆé–‹å§‹")
    
    data_service = DataManagerService()
    sensor_manager = SensorManager(data_service)
    
    def sensor_load():
        """ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿è² è·"""
        for i in range(1000):
            test_data = {
                'temperature_humidity': {
                    'temperature': 20 + random.random() * 20,
                    'humidity': 30 + random.random() * 50
                },
                'soil_moisture': {
                    'moisture_percentage': random.random() * 100
                },
                'water_level': {
                    'is_water_available': random.choice([True, False])
                }
            }
            data_service.save_sensor_data(test_data)
            time.sleep(0.1)
    
    def watering_load():
        """çµ¦æ°´è¨˜éŒ²è² è·"""
        for i in range(100):
            record = {
                'timestamp': datetime.now().isoformat(),
                'soil_moisture': random.random() * 100,
                'duration_seconds': 5,
                'water_amount_ml': 100,
                'success': True
            }
            data_service.save_watering_record(record)
            time.sleep(0.5)
    
    # ä¸¦è¡Œè² è·ãƒ†ã‚¹ãƒˆ
    threads = []
    threads.append(threading.Thread(target=sensor_load))
    threads.append(threading.Thread(target=watering_load))
    
    start_time = time.time()
    
    for thread in threads:
        thread.start()
    
    for thread in threads:
        thread.join()
    
    end_time = time.time()
    print(f"âœ… è² è·ãƒ†ã‚¹ãƒˆå®Œäº†: {end_time - start_time:.2f}ç§’")
```

---

## ğŸ“Š ãƒ†ã‚¹ãƒˆå®Ÿè¡Œæ‰‹é †

### 1. äº‹å‰æº–å‚™
```bash
# ã‚·ã‚¹ãƒ†ãƒ æº–å‚™
cd /home/pi/smart-planter
sudo systemctl stop smart-planter  # æ—¢å­˜ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢

# ãƒ†ã‚¹ãƒˆç’°å¢ƒç¢ºèª
python -c "import RPi.GPIO; print('GPIOåˆ©ç”¨å¯èƒ½')"
python -c "import smbus2; print('I2Cåˆ©ç”¨å¯èƒ½')"
python -c "import spidev; print('SPIåˆ©ç”¨å¯èƒ½')"
```

### 2. å€‹åˆ¥ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
```bash
# å„æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ
python test_sensors.py
python test_watering.py
python test_line_notify.py
python test_data_management.py
```

### 3. çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
```bash
# çµ±åˆãƒ†ã‚¹ãƒˆ
python test_integration.py
```

### 4. é•·æœŸãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
```bash
# é•·æœŸç¨¼åƒãƒ†ã‚¹ãƒˆï¼ˆãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œï¼‰
nohup python test_long_term.py > long_term_test.log 2>&1 &

# ãƒ­ã‚°ç¢ºèª
tail -f long_term_test.log
```

### 5. è² è·ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
```bash
# è² è·ãƒ†ã‚¹ãƒˆ
python test_load.py
```

---

## ğŸ“‹ ãƒ†ã‚¹ãƒˆå®Œäº†ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] å€‹åˆ¥æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆå®Œäº†
- [ ] ã‚»ãƒ³ã‚µãƒ¼çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†
- [ ] çµ¦æ°´çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†
- [ ] ã‚«ãƒ¡ãƒ©çµ±åˆãƒ†ã‚¹ãƒˆå®Œäº†
- [ ] ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ãƒ†ã‚¹ãƒˆå®Œäº†
- [ ] ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆå®Œäº†
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Œäº†
- [ ] é•·æœŸç¨¼åƒãƒ†ã‚¹ãƒˆå®Œäº†
- [ ] è² è·ãƒ†ã‚¹ãƒˆå®Œäº†
- [ ] ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå®Œäº†
- [ ] å•é¡Œç‚¹ã®ä¿®æ­£å®Œäº†

---

## ğŸ¯ ãƒ†ã‚¹ãƒˆæˆåŠŸåŸºæº–

### å¿…é ˆæ¡ä»¶
- å…¨å€‹åˆ¥æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆãŒæˆåŠŸ
- çµ±åˆãƒ†ã‚¹ãƒˆã®æˆåŠŸç‡ãŒ90%ä»¥ä¸Š
- 24æ™‚é–“é€£ç¶šç¨¼åƒã§ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãªã—
- ãƒ‡ãƒ¼ã‚¿æå¤±ãªã—

### æ¨å¥¨æ¡ä»¶
- çµ±åˆãƒ†ã‚¹ãƒˆã®æˆåŠŸç‡ãŒ95%ä»¥ä¸Š
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹æ™‚é–“ãŒä»•æ§˜å†…
- ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ãªã—
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ä½¿ç”¨é‡ãŒé©æ­£ç¯„å›²

---

**ä½œæˆæ—¥**: 2025å¹´1æœˆ
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0
**ãƒãƒ¼ãƒ **: KEBABS

